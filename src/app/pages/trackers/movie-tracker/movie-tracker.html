<div class="page">
  <header class="page-header">
    <h1 class="page-title">Movie of the Month</h1>
    <p class="page-subtitle">
      Odaberi mjesec i upiši film, opis, recenziju, omiljeni dio i poster.
    </p>
  </header>

  <section class="card movie-card">
    <div class="movie-header">
      <label class="field">
        <span class="field-label">Mjesec</span>
        <select
          class="field-input"
          [(ngModel)]="selectedMonthIndex"
          (change)="onMonthChange(+selectedMonthIndex)">
          <option *ngFor="let m of months; index as i" [ngValue]="i">
            {{ m }}
          </option>
        </select>
      </label>
    </div>

    <div class="movie-form">
      <div class="poster-column">
        <div class="poster-preview" *ngIf="form.posterDataUrl; else noPoster">
          <img [src]="form.posterDataUrl" alt="Poster filma" />
        </div>
        <ng-template #noPoster>
          <div class="poster-placeholder">Poster nije odabran</div>
        </ng-template>

        <label class="field poster-upload">
          <span class="field-label">Odaberite poster</span>
          <input
            class="field-input"
            type="file"
            accept="image/*"
            (change)="onPosterSelected($event)" />
        </label>
      </div>

      <div class="info-column">
        <label class="field">
          <span class="field-label">Naziv filma</span>
          <input
            class="field-input"
            type="text"
            [(ngModel)]="form.title" />
        </label>

        <label class="field">
          <span class="field-label">Kratki opis</span>
          <textarea
            class="field-input"
            rows="2"
            [(ngModel)]="form.description">
          </textarea>
        </label>

        <label class="field">
          <span class="field-label">Recenzija (utisak)</span>
          <textarea
            class="field-input"
            rows="3"
            [(ngModel)]="form.review">
          </textarea>
        </label>

        <label class="field">
          <span class="field-label">Omiljeni dio</span>
          <textarea
            class="field-input"
            rows="2"
            [(ngModel)]="form.favoriteScene">
          </textarea>
        </label>

        <div class="buttons-row">
          <button
            type="button"
            class="btn-primary"
            (click)="saveEntry()">
            Sačuvaj
          </button>
          <button
            type="button"
            class="btn-secondary"
            (click)="clearEntry()">
            Obriši ovaj mjesec
          </button>
        </div>
      </div>
    </div>
  </section>

  <section class="card movie-card">
    <h3 class="section-title">Pregled svih filmova u godini</h3>

    <div class="year-line">
      <div class="month-card" *ngFor="let m of months; index as i">
        <div class="month-name">{{ m }}</div>

        <ng-container *ngIf="getEntry(i) as entry; else emptyMonth">
          <div class="month-poster" *ngIf="entry.posterDataUrl">
            <img [src]="entry.posterDataUrl" alt="{{ entry.title }}" />
          </div>
          <div class="month-title">{{ entry.title }}</div>
        </ng-container>

        <ng-template #emptyMonth>
          <div class="month-empty">Nema filma</div>
        </ng-template>
      </div>
    </div>
  </section>
</div>
